# Chapter File Generator

## Обзор
Приложение с графическим интерфейсом (GUI) на **CustomTkinter** генерирует пустые файлы `.docx` для глав и их частей. Оно подгружает кастомный шрифт *Cattedrale* и иконку окна, запоминает размеры и шрифт между запусками.

## Установка и запуск
**Требования**: `customtkinter`, `python-docx`, `lxml`
```bash
pip install customtkinter python-docx lxml
```
Запуск из корня репозитория:
```bash
python cod.py
```

## Бизнес‑процесс
1. **Выбор папки** – нажмите «Выбрать папку» и укажите каталог для сохранения.
2. **Генерация файлов** – нажмите «Начать генерацию», ответьте на вопросы о количестве глав и частей.
3. **Разбивка документа** – нажмите «Разбить!» и выберите исходный `.docx`; каждая глава будет сохранена отдельно.
4. **Конвертация в FB2** – нажмите «Законвертить», выберите один или несколько `.docx` и укажите папку назначения; для каждого файла создаётся одноимённый `.fb2`.
5. **Проверка на артефакты** – нажмите «Проверка на артефакты»; найденные английские слова появятся во всплывающем окне.
6. **Загрузка глав** – нажмите «Залить на Rulate», затем заполните в диалоге URL книги, учётные данные и параметры публикации.

## Разбивка документа
1. Нажмите кнопку «Разбить!» и выберите исходный `.docx`.
2. Укажите папку назначения для сохранения глав.
3. Программа сохранит каждую найденную главу как `Глава N.docx`.

## Конвертация DOCX → FB2
1. Нажмите кнопку «Законвертить» и выделите все `.docx`, которые нужно преобразовать.
2. Укажите конечную папку. Для каждого исходного файла создастся одноимённый `.fb2` с блоком `<FictionBook><body><section><p>…</p></section></body></FictionBook>`.
3. По завершении появится всплывающее уведомление о количестве успешно обработанных и проблемных файлов.

## Проверка на артефакты
Нажмите «Проверка на артефакты» и выберите файл для анализа. Список английских слов отобразится во всплывающем окне.
Это помогает быстро выявить артефакты или непереведённые фразы.

## Архитектура и функции
```python
# Сбор ответов пользователя
 def ask_questions(self):
     total_dialog = CustomInputDialog(self, "Сколько ебануть?", self.custom_font, self.icon_path)
     ...

# Генерация структуры файлов
 def generate_files(self, save_location, total_chapters, parts_per_chapter):
     for chapter in range(1, total_chapters + 1):
         for part in range(1, parts_per_chapter + 1):
             file_name = f"Глава {chapter}.{part}.docx"
             Document().add_paragraph(" ").save(file_path)

# Всплывающее окно с сообщением
 def show_popup(self, message):
     popup = ctk.CTkToplevel(self, fg_color="#2f2f2f")
     ...
```
Другие вспомогательные функции включают `browse_folder` (выбор каталога), `show_font_settings` (настройка размера шрифта), `load_config` и `save_config` для работы с конфигурацией.

## Настройка
- **Шрифт**: кнопка `A` в правом верхнем углу открывает слайдер, позволяющий менять размер. Можно заменить файл шрифта в папке `fonts/`.
- **Иконка**: замените файл `ChatGPT Image 15 авг. 2025 г., 20_42_09.ico` или укажите другой путь в `Application.icon_path`.

## Конфигурация
При закрытии окна сохраняется файл `window.cfg` рядом с `cod.py`. Пример содержимого:
```
geometry=500x400+100+100
font_size=18
```
Удалите или измените файл, чтобы сбросить параметры.

## Загрузка на Rulate
### Параметры окна
- **URL книги** – адрес страницы книги на rulate.ru.
- **Логин** – имя пользователя для авторизации.
- **Пароль** – пароль к указанному аккаунту.
- **Отложенная публикация** – загрузить главы в черновик без публикации.
- **Подписка** – ограничить чтение только подписчикам.
- **Том** – номер тома для добавляемых глав.
- **Дата/время публикации** – плановое время публикации главы.

### Пример запуска CLI
```bash
python rulate_cli.py https://tl.rulate.ru/book/12345 ch1.docx ch2.docx \
  --username user --password secret --deferred --subscription \
  --volume 1 --publish-at "2025-08-15 20:42"
```

## Примеры использования
### Генерация пустых файлов
После запуска и ответов на вопросы будет создана структура:
```
Генерация_2025-08-15_20-42-09/
└─ Глава 1.1.docx
└─ Глава 1.2.docx
...
```
### Разбивка существующего документа
Исходный файл `roman.docx` будет разделён на главы в выбранной папке:
```
roman_glavy/
└─ Глава 1.docx
└─ Глава 2.docx
...
```
### Проверка на артефакты
Во всплывающем окне отображается список английских слов:
```
Found English words:
hello
world
```

